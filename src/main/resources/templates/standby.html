<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pastel Photo Slider</title>
    <link rel="stylesheet" href="css/standby.css">
</head>
<body>
<form id="redirect-form" action="oshome" method="get">
    <div class="slider-container">
        <div class="slider-frame" id="slider-frame"></div>
    </div>
</form>

<script>
    function getRandomPastelColor() {
        const r = Math.floor(Math.random() * 127 + 127);
        const g = Math.floor(Math.random() * 127 + 127);
        const b = Math.floor(Math.random() * 127 + 127);
        return `rgb(${r}, ${g}, ${b})`;
    }

    document.addEventListener("DOMContentLoaded", function () {
        const sliderFrame = document.getElementById('slider-frame');

        // 서버에서 선택된 이미지와 텍스트 데이터 가져오기
        fetch('/getImageTextData')
            .then(response => response.json())
            .then(items => {
                if (items.length === 0) {
                    const noImagesMessage = document.createElement('div');
                    noImagesMessage.textContent = '선택한 이미지가 없습니다.';
                    noImagesMessage.style.color = '#fff';
                    noImagesMessage.style.textAlign = 'center';
                    noImagesMessage.style.fontSize = '24px';
                    noImagesMessage.style.marginTop = '20px';
                    sliderFrame.appendChild(noImagesMessage);
                    return;
                }

                // 슬라이드 항목 생성
                items.forEach(item => {
                    const slideElement = document.createElement('div');
                    slideElement.className = 'slide';
                    slideElement.style.backgroundColor = getRandomPastelColor();

                    const imgElement = document.createElement('img');
                    imgElement.src = item.imageUrl;  // 서버에서 가져온 이미지 URL
                    imgElement.alt = 'Selected Photo';

                    const captionElement = document.createElement('p');
                    captionElement.textContent = item.text; // 서버에서 가져온 텍스트

                    slideElement.appendChild(imgElement);
                    slideElement.appendChild(captionElement);
                    sliderFrame.appendChild(slideElement);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    });

    // 페이지 클릭 시 osHome 페이지로 이동
    document.body.addEventListener('click', function () {
        document.getElementById('redirect-form').submit();
    });
</script>
</body>
</html>